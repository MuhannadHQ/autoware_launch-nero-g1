<launch>
  <arg name="launch_driver" default="true"/>

  <group>
    <push-ros-namespace namespace="gnss"/>

    <!-- Switch topic name -->
    <let name="navsatfix_topic_name" value="xsens/nav_sat_fix"/>
    <let name="orientation_topic_name" value="/autoware_orientation"/>

      <push-ros-namespace namespace="xsens"/>
      <!-- Xsens GNSS + RTK -->
      <group if="$(eval &quot;'$(var launch_driver)'">

        <node pkg="xsens_mti_ros2_driver" exec="xsens_mti_node" name="xsens_mti_node" respawn="true">
          <param from="$(find-pkg-share xsens_mti_ros2_driver)/param/xsens_mti_node.yaml"/>
          <remap from="/gnss" to="xsens/nav_sat_fix"/>
        </node>
        <!-- ntrip Client -->
        <include file="$(find-pkg-share ntrip)/launch/ntrip_launch.py"/>
      </group>
    
    <!-- GNSS-INS Converter Node -->
    <!-- <node pkg="gnss_ins_converter"
          exec="converter_node"
          name="gnss_ins_converter"
          output="screen"> -->

      <!-- Optional parameters -->
      <!-- <param name="rmse_x" value="0.01"/>
      <param name="rmse_y" value="0.01"/>
      <param name="rmse_z" value="0.02"/>
    </node> -->

    <!-- GNSS Twist Converter Node -->
    <!-- <node pkg="gnss_twist_convertor"
          exec="gnss_twist_convertor"
          name="gnss_twist_convertor"
          output="screen"/> -->

    <!-- NavSatFix to MGRS Pose -->
    <include file="$(find-pkg-share autoware_gnss_poser)/launch/gnss_poser.launch.xml">
      <arg name="input_topic_fix" value="$(var navsatfix_topic_name)"/>
      <arg name="input_topic_orientation" value="$(var orientation_topic_name)"/>

      <arg name="output_topic_gnss_pose" value="pose"/>
      <arg name="output_topic_gnss_pose_cov" value="pose_with_covariance"/>
      <arg name="output_topic_gnss_fixed" value="fixed"/>

      <arg name="use_gnss_ins_orientation" value="true"/>
     </include>

  </group>
</launch>
